<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Profile</title>
       <link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="style">
</head>

<div class="container">
    <div class="row">
        <div class="col-sm-12 mx-auto">
            <div class="card card-signin">
                <div class="card-body">
                    <h5 class="card-title">Requests</h5>
                    <div class="table-responsive scrollable">
                        <table class="table">
                            <thead>
                            <tr>
                                <th scope="col" id = "titleh">Title</th>
                                <th scope="col" id = "isbnh">ISBN</th>
                                <th scope="col" id = "authorh">Author</th>
                                <th scope="col" id = "descriptionh">Description</th>
                                <th scope="col" id = "conditionh">Condition</th>
                                <th scope="col" id = "publisherh">Publisher</th>
                                <th scope="col" id = "enddateh">End Date</th>
                                <th scope="col" id = "binh">Buy it now</th>
                                <th scope="col" id = "minimumpriceh">minimum price</th>
                            </tr>
                            
                            </thead>
                            <tr>
                                <td scope="col" ><input id = "title" type = "text"/></td>
                                <td scope="col" ><input id = "isbn" type = "text" /></td>
                                <td scope="col" ><input id = "author" type ="text"/></td>
                                <td scope="col" ><input id = "description" type = "text"/></td>
                                <td scope="col" ><select id = "condition"></select></td>
                                <td scope="col" ><select id = "genre"></select></td>
                                <td scope="col" ><input id = "publisher" type = "text"/></td>
                                <td scope="col" ><input id = "enddate" type = "date"/></td>
                                <td scope="col" ><input id = "buyitnow" type = "number"/></td>
                                <td scope="col" ><input id = "minimumprice" type = "number"/></td>
                            </tr>
                            <tbody id="newAuctionTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    <script rel = "text/javascript">
        function AjaxPost(url,body, func){
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function (){
                if(this.readyState==4 && this.status == 200){
                    func(this);
                }
            }
            xhr.open("POST",url,true);
           // xhr.setRequestHeader("Accept","application/json");
           // xhr.setRequestHeader("Content-Type","application/json");
            xhr.send(body);
        };

        function auctionForm(){
            var title  = document.getElementById("title");
            var isbn = document.getElementById("isbn");
            var author  = document.getElementById("author");
            var description = document.getElementById("description");
            var condition  = document.getElementById("condition");
            var publisher = document.getElementById("publisher");
            var date  = document.getElementById("date");
            var minimumPrice = document.getElementById("minimumPrice");
            var buyItNow  = document.getElementById("buyItNow");

            var newAuction = {
                "title":title.value,
                "isbn":isbn.value,
                "author":author.value,
                "description":description.value,
                "condition":condition.value,
                "publisher":publisher.value,
                "date":date.value,
                "minimumPrice":minimumPrice.value,
                "buyItNow":buyItNow.value
                };

            console.log(newAuction);
            AjaxPost("auction",JSON.stringify(newAuction),function(xhr){
                window.location.pathname=xhr.responseText;
                });
        }
    </script>
    
    <script rel = "text/javascript">
    function AjaxGet(url, func) {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                func(this);
            }
        }
        xhr.open("GET", url, true);
        xhr.send();
    };
    	function populateSelectGenre(xhr){
    		var res = JSON.parse(xhr.responseText);
    		var genre = document.getElementById("genre");
    		res.forEach(function(element){
    			var op = document.createElement("option");
    			op.innerText = element.name;
    			genre.add(op);
    		});
    	};
    	function populateSelectCondition(xhr){
    		var res = JSON.parse(xhr.responseText);
    		var genre = document.getElementById("condition");
    		res.forEach(function(element){
    			var op = document.createElement("option");
    			op.innerText = element.name;
    			genre.add(op);
    		});
    	};
    	function onload(){
    		AjaxGet("genre/all",populateSelectGenre);
    		AjaxGet("bookCondition/all",populateSelectCondition);
    	};
    	onload();
    </script>
</body>

</html>